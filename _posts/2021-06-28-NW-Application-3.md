---
layout: post
title: 애플리케이션 계층 [ 인터넷 전자메일 ]
description: >
  [컴퓨터 네트워킹 하향식 접근 정리] 애플리케이션 계층: 인터넷 전자메일
  참고 : https://dany-it.tistory.com/174
tags: [Network]
---

## 애플리케이션 계층

### 인터넷 전자 메일

전자메일은 비동기적인 통신 매체이다. 인터넷 메일 시스템의 상위 레벨 개념에는 **사용자 에이전트, 메일 서버, SMTP (Simple Mail Transfer Protocol)**라는 3가지 주요 요소가 존재한다.

![](https://taeho0304.github.io/assets/img/NW/application/email/mailsystem.png)

**사용자 에이전트**는 사용자가 메시지를 읽고, 응답하고, 전달하고,저장하고, 구성하게 해준다. 작성자가 메시지 작성을 끝내면, 사용자 에이전트는 메시지를 메일 서버로 보내고, 메시지는 서버의 출력 메시지 큐에 들어간다. 수신자의 사용자 에이전트는 메시지를 읽을 때 메일서버에 있는 메일박스에서 메시지를 가져온다.

**메일 서버**는 전자메일 기반구조의 중심으로 각 수신자는 메일 서버 안에 **메일박스(mailbox)**를 갖고 있다. 이 메일박스는 수신한 메시지를 유지하고 관리하는 역할을 수행한다. 일반 메시지는 송신자의 사용자 에이전트에서 전달이 시작되고, 송신자의 메일 서버를 거친 후 수신자의 메일 서버로 전달된다. 거기서 수신자의 메일박스에 저장되는 방식으로 전달이 이루어진다.

**SMTP**는 애플리케이션 계층 프로토콜로서, 메일을 송신자의 메일 서버로부터 수신자의 메일 서버로 전송하는 데 TCP의 신뢰적인 데이터 전송 서비스를 이용한다. 메일을 송신할 때는 SMTP의 클라이언트로 동작하고 수신할 때는 SMTP 서버로 동작한다.

### SMTP

SMTP는 HTTP보다 훨씬 오래된 프로토콜로, 모든 메일 메시지의 몸체는 단순한 7비트 ASCII이어야 한다는 단접이 있다. 따라서 SMTP를 통해 데이터를 보내기 위해서는 먼저 데이터를 ASCII로 변환 후 SMTP 전송을 해야한다. 전송 후에는 다시 ASCII를 원래 메시지로 변환하는 과정이 필요하다.

SMTP

1. 메세지를 작성하고 사용자 에이전트를 통해 메일을 전송하라고 명령한다.
2. 에이전트는 메시지를 메일 서버로 보내고 그곳에서 메시지는 메시지 큐에 놓인다.
3. 메일 서버는 수신 측과 TCP 연결을 시도한다.
4. 수신측에서 메시지를 수신한 뒤, 해당 메시지를 메일박스에 놓는다.
5. 수신측은 원하는 시간에 메시지를 읽기 위해 사용자 에이전트를 시동한다.

### SMTP와 HTTP 비교

첫째, **HTTP**는 원칙적으로 풀(pull)프로토콜이다. 누군가 서버에 정보를 올리고 사용자가 편의에 의해서 서버로부터 정보를 가져오기 위해 HTTP를 사용한다. 여기서 TCP연결은 파일을 수신할 컴퓨터가 먼저 초기화한다. 반면 **SMTP**눈 원칙적으로 푸시(push)프로토콜이다. 송신 메일 서버가 파일을 수신 메일 서버로 보낸다. 여기서 TCP 연글은 파일을 보내는 컴퓨터에서 먼저 초기화한다.

둘째, **SMTP**는 위에서 언급했던 것 처럼 메시지 전송 시 인코딩 작업이 필요하지만 **HTTP**는 이런 제한이 없다.

셋째, HTTP는 자신의 HTTP 응답 메시지에 각 객체를 캡슐화하지만 인터넷 메일은 모든 메시지의 객체를 한 메시지로 만든다.

### 메일 접속 프로토콜

수신자의 메일 서버거 개인 로컬 PC에 있다면, 수신자의 PC는 전자메일을 수신하기 위해 항상 켜져 있어야 한다는 문제가 발생한다. 이를 해결하기 위해 로컬 PC는 사용자 에이전트를 수행하고 늘 켜져있는 공유 메일 서버에 저장되는 메일박스에 접근한다.

![](https://taeho0304.github.io/assets/img/NW/application/email/emailprotocol.png)

위의 그림에서 아직 고려하지 않은 부분은 수신자의 사용자에이전트를 자신의 ISP 내부의 메일서버에 있는 자신을 메시지를 얻기위해 SMTP를 사용할 수 없다. ( SMTP는 push 프로토콜이지만 메시지를 얻는 것은 pull 동작이기 떄문) 이는 자신의 로컬 PC로 메시지를 전송하는 특별한 메일 액세스 프로토콜(POP3(Post Office Protocol), IMAP(Internet Messaging Access Protocol), HTTP)을 통해 해결할 수 있다.

**POP(Post Office Protocol)3**는 우리가 사용하는 기기에 정보를 저장한다. 즉, 서버에 있는 이메일을 조회할 경우 현재 사용하고 있는 기기에 다운로드한 뒤 서버에서는 삭제한다. (설정을 통해 서버에 복사본 저장 가능)

**IMAP**은 서버에서 내용을 불러온다. 즉, PC나 모바일에서 메일을 확인할 때 서버에 저장된 정보를 가져와서 내용을 보여주고 변경 사항을 동기화시켜준다. 그렇기 때문에, 여러 가지의 디바이스에서 접속하여도 항상 동일한 정보를 확인할 수 있다.
